{
  "hash": "a4c665b9ce6904258a922e1361737aed",
  "result": {
    "markdown": "---\ntitle: \"Exercise 04\"\norder: 4\ndate-due: 2023-09-25\ndate-modified: last-modified\n---\n\n\n::: {.callout-important appearance=\"minimal\" icon=\"true\"}\nExercise due on {{< meta date-due >}}\n:::\n\nℹ️ See [week\n{{< meta order >}}](https://bldgspatialdata.github.io/website/weeks/week_0%7B%7B%3C%20meta%20order%20%3E%7D%7D.html)\nfor related slides and readings\n\n## Overview\n\nThis week's exercises are excerpted from [Ch. 3 Attribute data\noperations](https://r.geocompx.org/attr) in Geocomputation with R. These\nexercises build on our last exercise using `{dplyr}` and include some of\nthe same skills including:\n\n-   Filtering or subsetting rows using attributes\n\nNew skills you will practice with this exercise include:\n\n-   Working with `unit` class attributes (columns)\n-   Joining datasets\n\n## Setup\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(sf)\n```\n:::\n\n\nWe are also going to use the `us_states` and `us_states_df` data from\nthe `{spData}` package:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(spData)\n```\n:::\n\n\n## Exercises\n\n### Filtering data\n\nFind all states with the following characteristics (bonus find and plot\nthem):\n\nBelong to the Midwest region.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nus_states |> \n  ____\n```\n:::\n\n\nBelong to the West region, have an area below 250,000 km2and in 2015 a\npopulation greater than 5,000,000 residents (hint: you may need to use\nthe function `units::set_units()` or `as.numeric()`).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nus_states |> \n  ____\n```\n:::\n\n\nBelong to the South region, had an area larger than 150,000 km2 or a\ntotal population in 2015 larger than 7,000,000 residents.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nus_states |> \n  ____\n```\n:::\n\n\nWhat was the total population in 2015 in the `us_states` dataset? What\nwas the minimum and maximum total population in 2015?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nus_states |> \n  ____\n```\n:::\n\n\n### Comparing and summarizing data\n\nAdd variables from `us_states_df` to `us_states`, and create a new\nobject called `us_states_stats`.\n\n-   What function did you use and why?\n-   Which variable is the key in both datasets?\n-   What is the class of the new object?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nus_states_stats <- us_states |> \n  ____\n```\n:::\n\n\n`us_states_df` has two more rows than `us_states`. **How can you find\nthem?**\n\nHint: try to use the `dplyr::anti_join()` function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n____(us_states, us_states_df)\n```\n:::\n\n\n**How much has population density changed between 2010 and 2015 in each\nstate?**\n\nCalculate the change in percentages and map them.\n\n\n::: {.cell}\n\n:::\n\n\nCalculate the change in the number of residents living below the poverty\nlevel between 2010 and 2015 for each state. (Hint: See `?us_states_df`\nfor documentation on the poverty level columns.)\n\n\n::: {.cell}\n\n:::\n\n\n**Bonus:** Calculate the change in the percentage of residents living\nbelow the poverty level in each state.\n\n\n::: {.cell}\n\n:::\n\n\nWhat was the minimum, average and maximum state's number of people\nliving below the poverty line in 2015 for each region?\n\n\n::: {.cell}\n\n:::\n\n\n**Bonus:** What is the region with the largest increase in people living\nbelow the poverty line?\n\n\n::: {.cell}\n\n:::\n\n\n### Spatial operations\n\nIt was established in Section\n[4.2](https://r.geocompx.org/spatial-operations#spatial-vec) that\nCanterbury was the region of New Zealand containing most of the 100\nhighest points in the country. How many of these high points does the\nCanterbury region contain?\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncanterbury <- nz |>\n  filter(Name == \"Canterbury\")\n\nnz_height\n```\n:::\n\n\n**Bonus:** plot the result using the `ggplot2::geom_sf()` function to\nshow all of New Zealand, `canterbury` region highlighted in yellow, high\npoints in Canterbury represented by red crosses (hint: `shape = 7`) and\nhigh points in other parts of New Zealand represented by blue circles.\nSee the help page `?ggplot2::shape` and run the examples to see an\nillustration of different `shape` values.\n\n\n::: {.cell}\n\n:::\n\n\nWhich region has the second highest number of `nz_height` points, and\nhow many does it have?\n\n\n::: {.cell}\n\n:::\n\n\nGeneralizing the question to all regions: how many of New Zealand\\'s 16\nregions contain points which belong to the top 100 highest points in the\ncountry? Which regions?\n\n\n::: {.cell}\n\n:::\n\n\n**Bonus:** create a table listing these regions in order of the number\nof points and their name. Hint: use `dplyr::slice_max()` and `gt::gt()`.\n\n\n::: {.cell}\n\n:::\n\n\nTest your knowledge of spatial predicates by finding out and plotting\nhow US states relate to each other and other spatial objects.\n\nThe starting point of this exercise is to create an object representing\nMaryland state in the USA using the\n[`filter()`](https://dplyr.tidyverse.org/reference/filter.html) function\nand plot the resulting object in the context of US states.\n\n\n::: {.cell}\n\n:::\n\n\nCreate a new object representing all the states that geographically\nintersect with Maryland and plot the result (hint: the most concise way\nto do this is with the subsetting method `[`).\n\n\n::: {.cell}\n\n:::\n\n\nCreate another object representing all the objects that touch (have a\nshared boundary with) Maryland and plot the result (hint: remember you\ncan use the argument `op = st_intersects` and other spatial relations\nduring spatial subsetting operations in base R).\n\n\n::: {.cell}\n\n:::\n\n\nBonus: create a straight line from the centroid of the District of\nColumbia near the East coast to the centroid of California near the West\ncoast of the USA (hint: functions\n[`st_centroid()`](https://r-spatial.github.io/sf/reference/geos_unary.html),\n[`st_union()`](https://r-spatial.github.io/sf/reference/geos_combine.html)\nand [`st_cast()`](https://r-spatial.github.io/sf/reference/st_cast.html)\ndescribed in Chapter 5 may help) and identify which states this long\nEast-West line crosses.\n\n\n::: {.cell}\n\n:::\n",
    "supporting": [
      "exercise_04_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}