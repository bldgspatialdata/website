{
  "hash": "a388a4d81b885d8be47b1576fe7f7b18",
  "result": {
    "engine": "knitr",
    "markdown": "---\norder: 2\ntitle: \"Visualizing spatial data with ggplot2\"\nsubtitle: \"Session {{< meta order >}}\"\ndate: 2023-09-06\nimage: \"images/qcbis_workshop03_gglayers-graphic.png\"\n# format:\n#  revealjs:\n#    output-location: column-fragment\n# code-fold: true\nfig-asp: 0.5625\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tinytable)\nlibrary(spData)\n```\n:::\n\n\n\n::: {.cell}\n\n:::\n\n\n# Overview\n\n-   Why and how do we visualize spatial data?\n-   What is the \"grammar of graphics\"?\n-   How to use `{ggplot2}` to\n    -   build layered data visualizations\n    -   visualize spatial data\n\n## Why and how do we visualize spatial data?\n\n### Why do we visualize spatial data?\n\n-   Validation\n-   Exploration\n-   Communication\n\n### Why do we visualize data?\n\n-   Validation\n-   Exploration\n-   Communication\n\n### Anscombe's quartet\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script src=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.js\"></script>\n\n    <script>\n      // Create table-specific functions using external factory\n      const tableFns_d25hzlxmtx1ypndrbj2g = TinyTable.createTableFunctions(\"tinytable_d25hzlxmtx1ypndrbj2g\");\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: '11', j: 1 }, { i: '11', j: 2 }, { i: '11', j: 3 }, { i: '11', j: 4 }, { i: '11', j: 5 }, { i: '11', j: 6 }, { i: '11', j: 7 }, { i: '11', j: 8 }, { i: '11', j: 9 }, { i: '11', j: 10 }, { i: '11', j: 11 }, { i: '11', j: 12 } ], css_id: 'tinytable_css_6r8b1rd752jzxoh2h218',}, \n          { positions: [ { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 }, { i: '0', j: 6 }, { i: '0', j: 7 }, { i: '0', j: 8 }, { i: '0', j: 9 }, { i: '0', j: 10 }, { i: '0', j: 11 }, { i: '0', j: 12 } ], css_id: 'tinytable_css_r9zqwq5rz4jqrv9yq5uy',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  tableFns_d25hzlxmtx1ypndrbj2g.styleCell(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.css\">\n    <style>\n    /* tinytable css entries after */\n    #tinytable_d25hzlxmtx1ypndrbj2g td.tinytable_css_6r8b1rd752jzxoh2h218, #tinytable_d25hzlxmtx1ypndrbj2g th.tinytable_css_6r8b1rd752jzxoh2h218 {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    #tinytable_d25hzlxmtx1ypndrbj2g td.tinytable_css_r9zqwq5rz4jqrv9yq5uy, #tinytable_d25hzlxmtx1ypndrbj2g th.tinytable_css_r9zqwq5rz4jqrv9yq5uy {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%; ; font-weight: bold }\n    </style>\n    <div class=\"container\">\n      <table class=\"tinytable\" id=\"tinytable_d25hzlxmtx1ypndrbj2g\" style=\"table-layout: fixed; width: 90% !important; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        \n        <thead>\n              <tr>\n                <th scope=\"col\" data-row=\"0\" data-col=\"1\">set</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"2\">x</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"3\">y</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"4\">set</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"5\">x</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"6\">y</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"7\">set</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"8\">x</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"9\">y</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"10\">set</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"11\">x</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"12\">y</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td data-row=\"1\" data-col=\"1\">I</td>\n                  <td data-row=\"1\" data-col=\"2\">10</td>\n                  <td data-row=\"1\" data-col=\"3\">8.04</td>\n                  <td data-row=\"1\" data-col=\"4\">II</td>\n                  <td data-row=\"1\" data-col=\"5\">10</td>\n                  <td data-row=\"1\" data-col=\"6\">9.14</td>\n                  <td data-row=\"1\" data-col=\"7\">III</td>\n                  <td data-row=\"1\" data-col=\"8\">10</td>\n                  <td data-row=\"1\" data-col=\"9\">7.46</td>\n                  <td data-row=\"1\" data-col=\"10\">IV</td>\n                  <td data-row=\"1\" data-col=\"11\">8</td>\n                  <td data-row=\"1\" data-col=\"12\">6.58</td>\n                </tr>\n                <tr>\n                  <td data-row=\"2\" data-col=\"1\">I</td>\n                  <td data-row=\"2\" data-col=\"2\">8</td>\n                  <td data-row=\"2\" data-col=\"3\">6.95</td>\n                  <td data-row=\"2\" data-col=\"4\">II</td>\n                  <td data-row=\"2\" data-col=\"5\">8</td>\n                  <td data-row=\"2\" data-col=\"6\">8.14</td>\n                  <td data-row=\"2\" data-col=\"7\">III</td>\n                  <td data-row=\"2\" data-col=\"8\">8</td>\n                  <td data-row=\"2\" data-col=\"9\">6.77</td>\n                  <td data-row=\"2\" data-col=\"10\">IV</td>\n                  <td data-row=\"2\" data-col=\"11\">8</td>\n                  <td data-row=\"2\" data-col=\"12\">5.76</td>\n                </tr>\n                <tr>\n                  <td data-row=\"3\" data-col=\"1\">I</td>\n                  <td data-row=\"3\" data-col=\"2\">13</td>\n                  <td data-row=\"3\" data-col=\"3\">7.58</td>\n                  <td data-row=\"3\" data-col=\"4\">II</td>\n                  <td data-row=\"3\" data-col=\"5\">13</td>\n                  <td data-row=\"3\" data-col=\"6\">8.74</td>\n                  <td data-row=\"3\" data-col=\"7\">III</td>\n                  <td data-row=\"3\" data-col=\"8\">13</td>\n                  <td data-row=\"3\" data-col=\"9\">12.74</td>\n                  <td data-row=\"3\" data-col=\"10\">IV</td>\n                  <td data-row=\"3\" data-col=\"11\">8</td>\n                  <td data-row=\"3\" data-col=\"12\">7.71</td>\n                </tr>\n                <tr>\n                  <td data-row=\"4\" data-col=\"1\">I</td>\n                  <td data-row=\"4\" data-col=\"2\">9</td>\n                  <td data-row=\"4\" data-col=\"3\">8.81</td>\n                  <td data-row=\"4\" data-col=\"4\">II</td>\n                  <td data-row=\"4\" data-col=\"5\">9</td>\n                  <td data-row=\"4\" data-col=\"6\">8.77</td>\n                  <td data-row=\"4\" data-col=\"7\">III</td>\n                  <td data-row=\"4\" data-col=\"8\">9</td>\n                  <td data-row=\"4\" data-col=\"9\">7.11</td>\n                  <td data-row=\"4\" data-col=\"10\">IV</td>\n                  <td data-row=\"4\" data-col=\"11\">8</td>\n                  <td data-row=\"4\" data-col=\"12\">8.84</td>\n                </tr>\n                <tr>\n                  <td data-row=\"5\" data-col=\"1\">I</td>\n                  <td data-row=\"5\" data-col=\"2\">11</td>\n                  <td data-row=\"5\" data-col=\"3\">8.33</td>\n                  <td data-row=\"5\" data-col=\"4\">II</td>\n                  <td data-row=\"5\" data-col=\"5\">11</td>\n                  <td data-row=\"5\" data-col=\"6\">9.26</td>\n                  <td data-row=\"5\" data-col=\"7\">III</td>\n                  <td data-row=\"5\" data-col=\"8\">11</td>\n                  <td data-row=\"5\" data-col=\"9\">7.81</td>\n                  <td data-row=\"5\" data-col=\"10\">IV</td>\n                  <td data-row=\"5\" data-col=\"11\">8</td>\n                  <td data-row=\"5\" data-col=\"12\">8.47</td>\n                </tr>\n                <tr>\n                  <td data-row=\"6\" data-col=\"1\">I</td>\n                  <td data-row=\"6\" data-col=\"2\">14</td>\n                  <td data-row=\"6\" data-col=\"3\">9.96</td>\n                  <td data-row=\"6\" data-col=\"4\">II</td>\n                  <td data-row=\"6\" data-col=\"5\">14</td>\n                  <td data-row=\"6\" data-col=\"6\">8.10</td>\n                  <td data-row=\"6\" data-col=\"7\">III</td>\n                  <td data-row=\"6\" data-col=\"8\">14</td>\n                  <td data-row=\"6\" data-col=\"9\">8.84</td>\n                  <td data-row=\"6\" data-col=\"10\">IV</td>\n                  <td data-row=\"6\" data-col=\"11\">8</td>\n                  <td data-row=\"6\" data-col=\"12\">7.04</td>\n                </tr>\n                <tr>\n                  <td data-row=\"7\" data-col=\"1\">I</td>\n                  <td data-row=\"7\" data-col=\"2\">6</td>\n                  <td data-row=\"7\" data-col=\"3\">7.24</td>\n                  <td data-row=\"7\" data-col=\"4\">II</td>\n                  <td data-row=\"7\" data-col=\"5\">6</td>\n                  <td data-row=\"7\" data-col=\"6\">6.13</td>\n                  <td data-row=\"7\" data-col=\"7\">III</td>\n                  <td data-row=\"7\" data-col=\"8\">6</td>\n                  <td data-row=\"7\" data-col=\"9\">6.08</td>\n                  <td data-row=\"7\" data-col=\"10\">IV</td>\n                  <td data-row=\"7\" data-col=\"11\">8</td>\n                  <td data-row=\"7\" data-col=\"12\">5.25</td>\n                </tr>\n                <tr>\n                  <td data-row=\"8\" data-col=\"1\">I</td>\n                  <td data-row=\"8\" data-col=\"2\">4</td>\n                  <td data-row=\"8\" data-col=\"3\">4.26</td>\n                  <td data-row=\"8\" data-col=\"4\">II</td>\n                  <td data-row=\"8\" data-col=\"5\">4</td>\n                  <td data-row=\"8\" data-col=\"6\">3.10</td>\n                  <td data-row=\"8\" data-col=\"7\">III</td>\n                  <td data-row=\"8\" data-col=\"8\">4</td>\n                  <td data-row=\"8\" data-col=\"9\">5.39</td>\n                  <td data-row=\"8\" data-col=\"10\">IV</td>\n                  <td data-row=\"8\" data-col=\"11\">19</td>\n                  <td data-row=\"8\" data-col=\"12\">12.50</td>\n                </tr>\n                <tr>\n                  <td data-row=\"9\" data-col=\"1\">I</td>\n                  <td data-row=\"9\" data-col=\"2\">12</td>\n                  <td data-row=\"9\" data-col=\"3\">10.84</td>\n                  <td data-row=\"9\" data-col=\"4\">II</td>\n                  <td data-row=\"9\" data-col=\"5\">12</td>\n                  <td data-row=\"9\" data-col=\"6\">9.13</td>\n                  <td data-row=\"9\" data-col=\"7\">III</td>\n                  <td data-row=\"9\" data-col=\"8\">12</td>\n                  <td data-row=\"9\" data-col=\"9\">8.15</td>\n                  <td data-row=\"9\" data-col=\"10\">IV</td>\n                  <td data-row=\"9\" data-col=\"11\">8</td>\n                  <td data-row=\"9\" data-col=\"12\">5.56</td>\n                </tr>\n                <tr>\n                  <td data-row=\"10\" data-col=\"1\">I</td>\n                  <td data-row=\"10\" data-col=\"2\">7</td>\n                  <td data-row=\"10\" data-col=\"3\">4.82</td>\n                  <td data-row=\"10\" data-col=\"4\">II</td>\n                  <td data-row=\"10\" data-col=\"5\">7</td>\n                  <td data-row=\"10\" data-col=\"6\">7.26</td>\n                  <td data-row=\"10\" data-col=\"7\">III</td>\n                  <td data-row=\"10\" data-col=\"8\">7</td>\n                  <td data-row=\"10\" data-col=\"9\">6.42</td>\n                  <td data-row=\"10\" data-col=\"10\">IV</td>\n                  <td data-row=\"10\" data-col=\"11\">8</td>\n                  <td data-row=\"10\" data-col=\"12\">7.91</td>\n                </tr>\n                <tr>\n                  <td data-row=\"11\" data-col=\"1\">I</td>\n                  <td data-row=\"11\" data-col=\"2\">5</td>\n                  <td data-row=\"11\" data-col=\"3\">5.68</td>\n                  <td data-row=\"11\" data-col=\"4\">II</td>\n                  <td data-row=\"11\" data-col=\"5\">5</td>\n                  <td data-row=\"11\" data-col=\"6\">4.74</td>\n                  <td data-row=\"11\" data-col=\"7\">III</td>\n                  <td data-row=\"11\" data-col=\"8\">5</td>\n                  <td data-row=\"11\" data-col=\"9\">5.73</td>\n                  <td data-row=\"11\" data-col=\"10\">IV</td>\n                  <td data-row=\"11\" data-col=\"11\">8</td>\n                  <td data-row=\"11\" data-col=\"12\">6.89</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\nA little hard to read!\n\n::: notes\nTo understand how visualization supports validation, we can take at the Anscombe's Quartet data from the `{Tmisc}`.\n:::\n\n------------------------------------------------------------------------\n\nTake a look at the data using some summary statistics:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTmisc::quartet |>\n  summarise(\n    across(c(x, y), c(mean = mean, sd = sd)),\n    r = cor(x, y),\n    .by = set\n  ) |>\n  relocate(ends_with(\"mean\"), .after = set) |>\n  tt(width = 0.9) |>\n  tt_style(i = 0, bold = TRUE) |>\n  tt_format(digits = 2)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script src=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.js\"></script>\n\n    <script>\n      // Create table-specific functions using external factory\n      const tableFns_n2xvp9ywymu49tj2mqlv = TinyTable.createTableFunctions(\"tinytable_n2xvp9ywymu49tj2mqlv\");\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: '4', j: 1 }, { i: '4', j: 2 }, { i: '4', j: 3 }, { i: '4', j: 4 }, { i: '4', j: 5 }, { i: '4', j: 6 } ], css_id: 'tinytable_css_zhus2ik0vm27c35wn1sp',}, \n          { positions: [ { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 }, { i: '0', j: 6 } ], css_id: 'tinytable_css_523xngd2yeq7yy9pax0p',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  tableFns_n2xvp9ywymu49tj2mqlv.styleCell(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.css\">\n    <style>\n    /* tinytable css entries after */\n    #tinytable_n2xvp9ywymu49tj2mqlv td.tinytable_css_zhus2ik0vm27c35wn1sp, #tinytable_n2xvp9ywymu49tj2mqlv th.tinytable_css_zhus2ik0vm27c35wn1sp {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    #tinytable_n2xvp9ywymu49tj2mqlv td.tinytable_css_523xngd2yeq7yy9pax0p, #tinytable_n2xvp9ywymu49tj2mqlv th.tinytable_css_523xngd2yeq7yy9pax0p {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%; ; font-weight: bold }\n    </style>\n    <div class=\"container\">\n      <table class=\"tinytable\" id=\"tinytable_n2xvp9ywymu49tj2mqlv\" style=\"table-layout: fixed; width: 90% !important; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        \n        <thead>\n              <tr>\n                <th scope=\"col\" data-row=\"0\" data-col=\"1\">set</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"2\">x_mean</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"3\">y_mean</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"4\">x_sd</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"5\">y_sd</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"6\">r</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td data-row=\"1\" data-col=\"1\">I</td>\n                  <td data-row=\"1\" data-col=\"2\">9</td>\n                  <td data-row=\"1\" data-col=\"3\">7.5</td>\n                  <td data-row=\"1\" data-col=\"4\">3.3</td>\n                  <td data-row=\"1\" data-col=\"5\">2</td>\n                  <td data-row=\"1\" data-col=\"6\">0.82</td>\n                </tr>\n                <tr>\n                  <td data-row=\"2\" data-col=\"1\">II</td>\n                  <td data-row=\"2\" data-col=\"2\">9</td>\n                  <td data-row=\"2\" data-col=\"3\">7.5</td>\n                  <td data-row=\"2\" data-col=\"4\">3.3</td>\n                  <td data-row=\"2\" data-col=\"5\">2</td>\n                  <td data-row=\"2\" data-col=\"6\">0.82</td>\n                </tr>\n                <tr>\n                  <td data-row=\"3\" data-col=\"1\">III</td>\n                  <td data-row=\"3\" data-col=\"2\">9</td>\n                  <td data-row=\"3\" data-col=\"3\">7.5</td>\n                  <td data-row=\"3\" data-col=\"4\">3.3</td>\n                  <td data-row=\"3\" data-col=\"5\">2</td>\n                  <td data-row=\"3\" data-col=\"6\">0.82</td>\n                </tr>\n                <tr>\n                  <td data-row=\"4\" data-col=\"1\">IV</td>\n                  <td data-row=\"4\" data-col=\"2\">9</td>\n                  <td data-row=\"4\" data-col=\"3\">7.5</td>\n                  <td data-row=\"4\" data-col=\"4\">3.3</td>\n                  <td data-row=\"4\" data-col=\"5\">2</td>\n                  <td data-row=\"4\" data-col=\"6\">0.82</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n::: notes\nGet the mean, standard deviation, and Pearson correlation coefficient for x and y.\n:::\n\n------------------------------------------------------------------------\n\nNow, take another look using a plot:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTmisc::quartet |>\n  ggplot(aes(x, y, color = set)) +\n  geom_smooth(method = \"lm\", alpha = 0.5, color = \"gray30\", linewidth = 0.25) +\n  geom_point() +\n  facet_wrap(~set) +\n  scale_color_brewer(palette = \"Dark2\", type = \"qual\") +\n  guides(color = \"none\") +\n  ges668_plot_theme +\n  theme(\n    plot.margin = margin(0)\n  )\n```\n\n::: {.cell-output-display}\n![](data-visualization_files/figure-revealjs/unnamed-chunk-4-1.png){width=576}\n:::\n:::\n\n\n::: notes\nWhat do you *see*?\n:::\n\n## How do we visualize spatial data?\n\n::::: columns\n::: {.column width=\"50%\"}\nA **map** is a special type of data visualization for spatial data but it isn't the only one.\n\n**Plots** and **tables** are other common ways to visualize spatial data.\n:::\n\n::: {.column width=\"50%\"}\n![Key for interpreting Sanborn fire insurance maps courtesy [Library of Congress](https://www.loc.gov/collections/sanborn-maps/about-this-collection/)](https://www.loc.gov/static/collections/sanborn-maps/images/sankey_in2.jpg)\n:::\n:::::\n\n------------------------------------------------------------------------\n\n::::: columns\n::: {.column width=\"40%\"}\nVisuals can be further transformed using **animation** and **interactivity**.\n\nMaps, graphics, and tables also vary in **format**: print, web, mobile, etc.\n:::\n\n::: {.column width=\"60%\"}\n![](https://media.giphy.com/media/xUA7aUs09Brz1ZED72/giphy.gif)\n:::\n:::::\n\n# What is the \"grammar of graphics\"?\n\n## Grammar of graphics {.unnumbered}\n\n![From The Grammar of Graphics for Introduction to data visualisation with ggplot2 QCBS R Workshop Series.](images/qcbis_workshop03_gglayers-graphic.png)\n\n::: notes\nConcept from *Grammar of Graphics* book (1999), from Leland Wilkinson.\n:::\n\n## Grammar of graphics {.unnumbered}\n\n-   Data\n-   Mapping\n-   Statistics\n-   Scales\n-   Geometries\n-   Facets\n-   Coordinates\n-   Theme\n\n::: footer\nIntroduction to the \"grammar of graphics\" adapted from a 2020 ggplot2 workshop ([part 1](https://www.youtube.com/watch?v=h29g21z0a68)) by Thomas Lin Pedersen.\n:::\n\n## Data\n\n-   Structure and representation of data determines what you *can* and *can't* do with it\n-   Data is expected to be in a \"tidy\" format (a.k.a. long format data)\n\n------------------------------------------------------------------------\n\nA few definitions:\n\n-   **variable**: a quantity, quality, or property that you can measure.\n-   **value**: the state of a variable when you measure it. The value of a variable may change from measurement to measurement.\n-   **observation**: a set of measurements made under similar conditions\n-   **tabular data**: a set of values, each associated with a variable and an observation.\n\n::: aside\nExcerpted from [Ch. 2 of R for Data Science](https://r4ds.hadley.nz/data-visualize).\n:::\n\n------------------------------------------------------------------------\n\nWhat works best with the grammar of graphics is **tidy data**:\n\n-   each value is placed in its own \"cell\",\n-   each variable in its own column, and\n-   each observation in its own row.\n\n<!--\nUse `ggplot()` to set `data` for a plot:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = us_states)\n```\n\n::: {.cell-output-display}\n![](data-visualization_files/figure-revealjs/unnamed-chunk-5-1.png){width=576}\n:::\n:::\n\n-->\n\n## Mapping\n\n-   Mapping allows data to be understood by the graphics system\n\n    -   **Aesthetic mapping**: variables -\\> graphical properties in the geometry\n    -   **Facet mapping**: variables -\\> panels in layout\n\n<!--\n\nUse the `aes()` function to define an aesthetic mapping for a plot:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = us_states, aes(fill = total_pop_15))\n```\n\n::: {.cell-output-display}\n![](data-visualization_files/figure-revealjs/unnamed-chunk-6-1.png){width=576}\n:::\n:::\n\n\n-->\n\n## Statistics\n\n-   Data may not represent the displayed values\n\n-   Statistics transform input variables into displayed values, e.g.\n\n    -   Counting the number of observations by category\n    -   Calculating summary statistics for a boxplot\n\n::: footer\nStatistics can be used prior to plotting data or used by a plotting function directly.\n:::\n\n## Scales\n\n-   Scales translate between value ranges and graphical properties, e.g.\n\n    -   Categories -> Colors\n    -   Numbers -> Position\n\n-   Scales use a specific type of interpolation, e.g. discrete, continuous, etc., so not all scales work with all variables.\n\n::: footer\nIn the not too common case where data directly represents a graphical property, e.g. a \"color\" column, you can use a special type of scale called an \"identity\" scale.\n:::\n\n## Geometries\n\n-   How translate aesthetics into graphical representations\n\n-   Basic geometries (e.g. points, lines, polygons) can be combined into more complex geometries (e.g. box plot, map)\n\n-   Typically, the geometries are the same as the \"type\" of plot\n\n## Facets\n\n-   Defines how data is split across multiple panels\n\n## Coordinates\n\n-   Positional aesthetics must be interpreted by a coordinate system\n\n-   Defines the physical mapping of aesthetics to the paper\n\n::: footer\nWe usually think about the [cartesian coordinate system](https://en.wikipedia.org/wiki/Cartesian_coordinate_system)â€”but there are a lot of different kinds of coordinate systems.\n:::\n\n## Theme\n\n-   Every other part of the graphic that *isn't* linked to the data:\n\n    -   Fonts\n    -   Spacing\n    -   Colors\n    -   Weights\n    -   etc.\n\n# How to to use `{ggplot2}` to...\n\n-   build layered data visualizations\n-   visualize spatial data\n\n::: notes\nconsiderations when visualizing spatial data with ggplot2:\n\n-   feature geometry and aesthetics are related\n-   spatial data benefits from reference geography\n-   other cartographic needs\n\nhow to visualize spatial data with ggplot2:\n\n-   make a map with `geom_sf`\n-   change CRS with `coord_sf`\n-   \"zoom\" to an area with `st_bbox` and `coord_sf`\n-   modify geometry type `st_centroid`\n\nhow to visualize spatial data with mapview:\n\n-   make a map with `mapview`\n-   make a color-coded map with the `zcol` argument\n-   make a map with multiple layers by passing a list to `mapview`\n:::\n\n## Cheatsheets\n\n-   [ggplot2 data visualization cheatsheet](https://rstudio.github.io/cheatsheets/html/data-visualization.html)\n\n## Build layered data visualizations\n\n## Setup\n\nFor this session, we are going to use the `{ggplot2}` and `{dplyr}` packages along with `{sf}` and `{rnaturalearth}`:\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(sf)\nlibrary(rnaturalearth)\n```\n:::\n\n\n## Setup data\n\nNext, we are going to use the `storms` data included with `{dplyr}`.\n\nTake a quick look at `storms` using `glimpse()`:\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nglimpse(storms)\n#> Rows: 19,537\n#> Columns: 13\n#> $ name                         <chr> \"Amy\", \"Amy\", \"Amy\", \"Amy\", \"Amy\", \"Amâ€¦\n#> $ year                         <dbl> 1975, 1975, 1975, 1975, 1975, 1975, 19â€¦\n#> $ month                        <dbl> 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,â€¦\n#> $ day                          <int> 27, 27, 27, 27, 28, 28, 28, 28, 29, 29â€¦\n#> $ hour                         <dbl> 0, 6, 12, 18, 0, 6, 12, 18, 0, 6, 12, â€¦\n#> $ lat                          <dbl> 27.5, 28.5, 29.5, 30.5, 31.5, 32.4, 33â€¦\n#> $ long                         <dbl> -79.0, -79.0, -79.0, -79.0, -78.8, -78â€¦\n#> $ status                       <fct> tropical depression, tropical depressiâ€¦\n#> $ category                     <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NAâ€¦\n#> $ wind                         <int> 25, 25, 25, 25, 25, 25, 25, 30, 35, 40â€¦\n#> $ pressure                     <int> 1013, 1013, 1013, 1013, 1012, 1012, 10â€¦\n#> $ tropicalstorm_force_diameter <int> NA, NA, NA, NA, NA, NA, NA, NA, NA, NAâ€¦\n#> $ hurricane_force_diameter     <int> NA, NA, NA, NA, NA, NA, NA, NA, NA, NAâ€¦\n```\n:::\n\n\n::: footer\nRemember! Each row is an *(observation** of a storm, not a individual storm.\n:::\n\n------------------------------------------------------------------------\n\n`storms` is a subset of a larger [Atlantic hurricane database (HURDAT2)](https://www.nhc.noaa.gov/data/#hurdat) with data from 1851 to 2022.\n\n::: {.columns}\n::: {.column}\n![](https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExaWtjY2dycDRzZ2djNHQ4MDh6Nm50dGYzbWF4ZHNkNGdkc3N2azB3OSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/7j0i4tSogPfq9rDxsB/giphy.gif)\n:::\n::: {.column}\nSince 1974, NOAA's [Geostationary Operational Environmental Satellite](https://en.wikipedia.org/wiki/Geostationary_Operational_Environmental_Satellite) program has played a key role in tracking storms and monitoring weather around the world.\n:::\n:::\n<!-- end columns -->\n\n## Create a `ggplot`\n\nWe can start by using the function `ggplot()` to define a plot object. Set `storm` as the input data for `ggplot()`:\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nggplot(data = storms)\n```\n\n::: {.cell-output-display}\n![](data-visualization_files/figure-revealjs/unnamed-chunk-9-1.png){width=576}\n:::\n:::\n\n\nWell, that doesn't look like much. ðŸ¤”\n\n::: footer\nThis is the first step in creating a plot that we can add layers to. Parameters set with `ggplot()` are *inherited* by layers added later.\n:::\n\n## Add aesthetics and layers\n\n### Set mapping with `aes()`\n\nNext, we can set the mapping using the `aes()` function. We can start by mapping `long` (longitude) to `x` and `lat` (latitude) to `y`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(\n  data = storms,\n  mapping = aes(\n    x = long,\n    y = lat\n  )\n)\n```\n\n::: {.cell-output-display}\n![](data-visualization_files/figure-revealjs/unnamed-chunk-10-1.png){width=576}\n:::\n:::\n\n\nBefore we can see any data, we need to tell `ggplot()` how we want to represent the data using layers.\n\n::: notes\nThe mapping argument of the ggplot() function defines how variables in your dataset are mapped to visual properties (aesthetics) of your plot.\n\nNote that the storms data is *not* spatial at this point.\n:::\n\n------------------------------------------------------------------------\n\nLayers in `{ggplot2}` are most often added using \"geoms\" (short for geometry) functions like `geom_point()`, `geom_col()`, or `geom_histogram()`.\n\nLet's give it a try using `geom_point()`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(\n  data = storms,\n  mapping = aes(\n    x = long,\n    y = lat\n  )\n) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](data-visualization_files/figure-revealjs/unnamed-chunk-11-1.png){width=576}\n:::\n:::\n\n\n------------------------------------------------------------------------\n\nYou can define the `data` and `mapping` parameters globally using `ggplot()` or locally for a single geom function. This code does the exact same thing as the prior block:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() +\n  geom_point(\n    mapping = aes(\n      x = long,\n      y = lat\n    ),\n    data = storms\n  )\n```\n\n::: {.cell-output-display}\n![](data-visualization_files/figure-revealjs/unnamed-chunk-12-1.png){width=576}\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n### What is this `+` operator?\n\nNotice that we are combining the `ggplot()` and `geom_point()` functions using the `+` operator.\n\nThis is a style of function or operator known as an [infix operator](https://en.wikipedia.org/wiki/Infix_notation).\n\nThis operator works is similar to the pipe operator, `%>%` or `|>` that passes the output from one function (or line of code) to the next line as the first parameter in a following function.\n\n------------------------------------------------------------------------\n\nFor example, see how we can use a series of pipes to operate on the storms data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstorms |>\n  distinct(name)\n#> # A tibble: 260 Ã— 1\n#>   name    \n#>   <chr>   \n#> 1 Amy     \n#> 2 Blanche \n#> 3 Caroline\n#> 4 Doris   \n#> 5 Eloise  \n#> 6 Faye    \n#> # â„¹ 254 more rows\n```\n:::\n\n\n------------------------------------------------------------------------\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstorms |>\n  distinct(name) |>\n  nrow()\n#> [1] 260\n```\n:::\n\n\n------------------------------------------------------------------------\n\nThe prior block is the same as the following block:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstorm_names <- distinct(storms, name)\nnrow(storm_names)\n#> [1] 260\n```\n:::\n\n\n::: footer\nUsing pipes can help avoid the need for intermediate objects like `storm_names` that might only exist to move the output of one function to the input for another function.\n:::\n\n------------------------------------------------------------------------\n\nThe first parameter for `ggplot()` is `data` and the first parameter for all geom functions is `mapping` so you often see these passed as unnnamed parameters:\n\n\n::: {.cell output-location='slide'}\n\n```{.r .cell-code  code-fold=\"false\"}\nggplot(storms) +\n  geom_point(\n    aes(\n      x = long,\n      y = lat\n    )\n  )\n```\n\n::: {.cell-output-display}\n![](data-visualization_files/figure-revealjs/unnamed-chunk-16-1.png){width=576}\n:::\n:::\n\n\n::: notes\nSee how the plot is now showing axis labels.\n:::\n\n------------------------------------------------------------------------\n\nYou can even leave off the x and y parameter names:\n\n\n::: {.cell output-location='slide'}\n\n```{.r .cell-code  code-fold=\"false\"}\nggplot(storms) +\n  geom_point(aes(long, lat))\n```\n\n::: {.cell-output-display}\n![](data-visualization_files/figure-revealjs/unnamed-chunk-17-1.png){width=576}\n:::\n:::\n\n\n::: aside\nFunction parameters can be specified by *position* as well as *name*.\n:::\n\n------------------------------------------------------------------------\n\n::: callout-tip\n\n### Mapping variables are not strings!\n\nThe variables passed to `aes()` don't have quotes around them! This is because `aes()` is a data-masking (also known as a quoting function) where the inputs are evaluated in the context of the data.\n\nTLDR: only put quotes around your aesthetic mappings when you want to pass a literal string.\n:::\n\n------------------------------------------------------------------------\n\nNext we can map one of the variables (`status` or storm classification) to an aesthetic (`color`):\n\n\n::: {.cell output-location='slide'}\n\n```{.r .cell-code  code-fold=\"false\"}\nggplot(storms) +\n  geom_point(aes(long, lat, color = status))\n```\n\n::: {.cell-output-display}\n![](data-visualization_files/figure-revealjs/unnamed-chunk-18-1.png){width=576}\n:::\n:::\n\n\nNote that we now have a legend, added automatically when we defined a mapping to color. Since color is not a \"positional aesthetic\" we can't easily interpret the meaning of the graphic without a legend, labels, or annotations.\n\n------------------------------------------------------------------------\n\nIn addition mapped aesthetics, we can set \"fixed\" aesthetics (called fixed because the same value is used for every observation in the plot).\n\n------------------------------------------------------------------------\n\nWhen you have a lot of overlapping features (known as *overplotting*), you may want to reduce the `alpha` (or transparency) of the features:\n\n\n::: {.cell output-location='slide'}\n\n```{.r .cell-code  code-fold=\"false\"}\nggplot(storms) +\n  geom_point(\n    aes(\n      x = long,\n      y = lat,\n      color = status\n    ),\n    alpha = 0.4\n  )\n```\n\n::: {.cell-output-display}\n![](data-visualization_files/figure-revealjs/unnamed-chunk-19-1.png){width=576}\n:::\n:::\n\n\nFixed aesthetics should be defined for each geomâ€”they are ignored if you pass them to `ggplot()`.\n\n------------------------------------------------------------------------\n\nAesthetics can also be defined using a function. In this example, we are using the boolean operator `==` to compare the values from \"status\" to the string \"hurricane\":\n\n\n::: {.cell output-location='slide'}\n\n```{.r .cell-code  code-fold=\"false\"}\nggplot(\n  data = storms,\n  mapping = aes(\n    x = long,\n    y = lat,\n    color = status == \"hurricane\"\n  )\n) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](data-visualization_files/figure-revealjs/unnamed-chunk-20-1.png){width=576}\n:::\n:::\n\n\n## Visualizing distributions\n\n## Distribution of one numeric variable\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(\n  data = storms,\n  mapping = aes(y = lat)\n) +\n  geom_histogram(bins = 90)\n```\n\n::: {.cell-output-display}\n![](data-visualization_files/figure-revealjs/unnamed-chunk-21-1.png){width=576}\n:::\n:::\n\n\n## Distribution of one numeric variable\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(\n  data = storms,\n  mapping = aes(x = lat)\n) +\n  geom_freqpoly(binwidth = 1)\n```\n\n::: {.cell-output-display}\n![](data-visualization_files/figure-revealjs/unnamed-chunk-22-1.png){width=576}\n:::\n:::\n\n\n## Distribution of one categorical variable\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(\n  data = storms,\n  mapping = aes(y = category)\n) +\n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](data-visualization_files/figure-revealjs/unnamed-chunk-23-1.png){width=576}\n:::\n:::\n\n\n# Visualize spatial data\n\nTo start, let's convert our storms data set from a data frame into a sf object using `sf::st_as_sf()`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstorms_sf <- sf::st_as_sf(\n  storms,\n  coords = c(\"long\", \"lat\"),\n  crs = 4326\n)\n```\n:::\n\n\n::: {.callout-tip collapse=\"false\" appearance=\"default\" icon=\"true\"}\n# Always supply coordinates with longitude before latitude!\n\n`sf::st_as_sf()` requires that you supply coordinates in lon lat order. This is also the standard order for GeoJSON files, Shapefiles, and KML files. Check out [lon lat lat lon by Tom MacWright](https://macwright.com/lonlat/) for more information.\n:::\n\n------------------------------------------------------------------------\n\nFinally, we can look at these observations on a map:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = storms_sf) +\n  geom_sf(aes(color = status))\n```\n\n::: {.cell-output-display}\n![](data-visualization_files/figure-revealjs/unnamed-chunk-25-1.png){width=576}\n:::\n:::\n\n\n------------------------------------------------------------------------\n\nThat first map may not look much different.\n\nBut converting the data to a `sf` object allows us to use `coord_sf()` to transform the coorindate reference system on the fly:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = storms_sf) +\n  geom_sf(aes(color = status)) +\n  coord_sf(crs = \"EPSG:3035\")\n```\n\n::: {.cell-output-display}\n![](data-visualization_files/figure-revealjs/unnamed-chunk-26-1.png){width=576}\n:::\n:::\n\n\n------------------------------------------------------------------------\n\nThis is equivalent to converting the coordinate reference system in advance using `st_transform()`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstorms_sf |>\n  st_transform(2804) |>\n  ggplot() +\n  geom_sf(aes(color = status))\n```\n\n::: {.cell-output-display}\n![](data-visualization_files/figure-revealjs/unnamed-chunk-27-1.png){width=576}\n:::\n:::\n\n\nNote, that this is another example of how we can use the pipe (`|>`) to move data between functions in R.\n\n------------------------------------------------------------------------\n\nHowever, to really show the potential, we need some more data. Install and load the `{rnaturalearth}` package and then load data for the coastline and countries:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# pak::pkg_install(c(\"rnaturalearth\", \"rnaturalearthdata\"))\nlibrary(rnaturalearth)\n\ncoastline <- ne_coastline()\n\ncountries <- ne_countries()\n```\n:::\n\n\n------------------------------------------------------------------------\n\nPut them together and we are starting to get somehwere:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() +\n  geom_sf(data = storms_sf, aes(color = status)) +\n  geom_sf(data = coastline, color = \"white\")\n```\n\n::: {.cell-output-display}\n![](data-visualization_files/figure-revealjs/unnamed-chunk-29-1.png){width=576}\n:::\n:::\n\n\n------------------------------------------------------------------------\n\nBut the map is zoomed out to show the whole worldâ€”not just the north Atlantic storm observations. We can use the xlim and ylim parameters of `coord_sf()` to \"zoom\" in on a smaller area:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstorms_bbox <- storms_sf |>\n  st_transform(\"EPSG:3035\") |>\n  st_bbox()\n\nstorms_map <- ggplot() +\n  geom_sf(data = countries, fill = \"white\") +\n  geom_sf(data = storms_sf, aes(color = category), alpha = 0.3) +\n  geom_sf(data = coastline, color = \"black\") +\n  coord_sf(\n    xlim = c(storms_bbox$xmin, storms_bbox$xmax),\n    ylim = c(storms_bbox$ymin, storms_bbox$ymax),\n    crs = \"EPSG:3035\"\n  )\n\nstorms_map\n```\n\n::: {.cell-output-display}\n![](data-visualization_files/figure-revealjs/unnamed-chunk-30-1.png){width=576}\n:::\n:::\n\n\n------------------------------------------------------------------------\n\nTry adding a scale:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstorms_map <- storms_map +\n  scale_color_distiller(\n    type = \"seq\",\n    direction = 1,\n    palette = \"YlOrRd\",\n    na.value = \"gray60\"\n  )\n\nstorms_map\n```\n\n::: {.cell-output-display}\n![](data-visualization_files/figure-revealjs/unnamed-chunk-31-1.png){width=576}\n:::\n:::\n\n\n------------------------------------------------------------------------\n\nNow try adding some labels:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstorms_map <- storms_map +\n  labs(\n    title = \"Atlantic hurricanes by category, 1975-2021\",\n    caption = \"Data: NOAA Atlantic hurricane database best track data via the {dplyr package}\"\n  )\n\nstorms_map\n```\n\n::: {.cell-output-display}\n![](data-visualization_files/figure-revealjs/unnamed-chunk-32-1.png){width=576}\n:::\n:::\n\n\n------------------------------------------------------------------------\n\nLastly, we can adjust the theme:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstorms_map +\n  theme_minimal() +\n  theme(\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](data-visualization_files/figure-revealjs/unnamed-chunk-33-1.png){width=576}\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n::::: columns\n::: {.column width=\"40%\"}\n![](https://images.routledge.com/common/jackets/amazon/978036749/9780367494759.jpg)\n:::\n\n::: {.column width=\"60%\"}\n\"It's true that there are better and worse ways to make a map but **no one way to make an excellent map**.\"\n\nGretchen N. Peterson in GIS Cartography: A Guide to Effective Map Design\n:::\n:::::\n\n### What makes a bad map *bad*?\n\nFor new map makers who might not know any better, it is often:\n\n-   Confusing or distracting layout\n-   Not enough color contrast for features\n-   Cluttered labels, legends, or features\n\n### What makes a fine map *just* fine?\n\nFor more experienced map makers who might be in a hurry:\n.\n-   Not enough thought on font sizes and styling\n-   No feature generalization (simplifying geometry where appropriate for the map scale or subject)\n-   Inappropriate color scales\n\n### Other related considerations\n\nThere are many cartographic considerations that also apply to other all types of data visualization:\n\n-   Layout\n-   Fonts (Typography)\n-   Colors\n-   Output formats\n\n### Other cartography considerations\n\nBut there are also some cartographic considerations that apply to maps in special and important ways:\n\n-   Feature geometry (and cartographic conventions)\n-   Projections\n-   Scaling\n",
    "supporting": [
      "data-visualization_files/figure-revealjs"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}