---
title: "Reading and writing spatial data"
---

## Spatial data is everywhere

- Shapefiles, GeoJSON files, and other spatial data files
- Spatial data editing and hosting services, e.g. [ArcGIS Online](https://www.esri.com/en-us/arcgis/products/arcgis-online/overview) or [Felt](https://felt.com/maps/recent))
- Open data portals serving spatial and non-spatial data, e.g. [data.gov](https://data.gov/)

## Spatial data is everywhere

- Google Maps, Apple Maps, Waze, and navigation apps (on your phone or [in your vehicle](https://support.google.com/googleappsincar/answer/9941814?hl=en))
- Biking and running apps (Strava publishes a [global user activity heatmap](https://www.strava.com/heatmap#11.21/-76.64618/39.34348/hot/all))
- Web browsers on your phone and desktop application

## Spatial data is everywhere

- Phone camera photos (stored in the EXIF metadata)
- Calendars ([iCal](https://en.wikipedia.org/wiki/ICalendar)), contacts ([vCard](https://en.wikipedia.org/wiki/VCard)), and emails (using [IP address](https://en.wikipedia.org/wiki/Internet_geolocation) locations)

## Creating spatial data is "easy"

- GIS Desktop applications, e.g. [QGIS](https://qgis.org/)
- Web mapping applications (e.g. [geojson.io](https://geojson.io/#map=2/0/20), [Felt](https://felt.com/))
- Spreadsheet applications (e.g. [Google Sheets](https://sheets.google.com/))
- Database builders (e.g. [Airtable](https://airtable.com/) or [Microsoft Lists](https://support.microsoft.com/en-us/office/introduction-to-lists-0a1c3ace-def0-44af-b225-cfa8d92c52d7))

## What can we do with it all?

- Read and write spatial data files
- Read and write related data files
- Read from and write to web services

## Common spatial file formats

- Shapefile (`.shp`)
- GeoJSON (`.json`, `.geojson`)
- GeoPackage (`.gpkg`)
- KML - Keyhole Markup Language (`.kml`)
- Esri File Geodatabase (`.gdb`)

::: notes

- Vector spatial: Shapefile, [GeoJSON](https://en.wikipedia.org/wiki/GeoJSON), KML
- Raster spatial: [GeoTIFF](https://en.wikipedia.org/wiki/GeoTIFF), 
- Tabular data with geometry: CSV, Microsoft Excel, delimited text with coordinates or WKT (well known text)

:::

## Read spatial data files with R

The `dsn` or data source name for `sf::read_sf()` can include:

- a file name
- a URL
- a folder
- the name and access credentials of a database
- a character string with the contents of a GeoJSON file

## Read spatial data files with R

You can use the `query` parameter of `sf::read_sf()` to use a SQL query to select records from a file (or select a specific geographical extent).
  
## Many file formats *can* include spatial data

- Excel files (`xlsx` or `xls`)  
- vCard or VCF (Virtual Contact File)
- EXIF metadata in a JPEG, HEIC, PNG, TIFF or other media file

## Reading data into R
  
- Read data using `{sf}`
- Read data using a package that returns a `sf` object
- Read data and use `{sf}` to convert to a `sf` object

## Writing data from R

- Write data to a spatial file using `{sf}`
- Write data a a non-spatial file using a different package

When you write spatial data to a non-spatial format, you should drop the geometry or convert the geometry to coordinates or well-known text.


## Storing and creating data

- Tabular: CSV, Microsoft Excel, delimited text
- Nested: JSON

----

![](https://www.census.gov/content/dam/Census/newsroom/blogs/2016/04/understanding-census-bureau-address-ranges/Orris-figure.jpg)

::: notes
Census data

:::

----

![](https://r-spatial.org/images/gis2.png)

----

![](https://r-spatial.org/images/gis3.png)

---

![](https://i0.wp.com/transportgeography.org/wp-content/uploads/esri_shapefile_model.png?w=1800&ssl=1)

::: notes

Shapefile model
:::

----

![](https://developers.google.com/static/kml/documentation/images/classTree52.gif)
::: notes

KML

Source: https://developers.google.com/kml/documentation/kmlreference
:::

![](https://wiki.openstreetmap.org/w/images/thumb/1/10/ERD_of_OSM_DB.svg/1280px-ERD_of_OSM_DB.svg.png)

::: notes

Open Street Map

SVG: https://wiki.openstreetmap.org/wiki/File:ERD_of_OSM_DB.svg
:::

----


![](https://www.e-education.psu.edu/geog583/sites/www.e-education.psu.edu.geog583/files/OGC_Standards.jpg)
